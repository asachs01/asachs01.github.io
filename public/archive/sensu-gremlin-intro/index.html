<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="Using chaos engineering principles to enhance your monitoring tools"><title>Badass Monitoring, Pt 1: Sensu & Gremlin</title><link rel=canonical href=https://aaron.sachs.blog/archive/sensu-gremlin-intro/><link rel=stylesheet href=/scss/style.min.946cca6c6259ef94ac55abfae7c7bf3291ea3ed5eea17ef77500b257217c6710.css><meta property='og:title' content="Badass Monitoring, Pt 1: Sensu & Gremlin"><meta property='og:description' content="Using chaos engineering principles to enhance your monitoring tools"><meta property='og:url' content='https://aaron.sachs.blog/archive/sensu-gremlin-intro/'><meta property='og:site_name' content='Staring Blankly at a Screen'><meta property='og:type' content='article'><meta property='article:section' content='Archive'><meta property='article:tag' content='sensu'><meta property='article:tag' content='gremlin'><meta property='article:tag' content='monitoring'><meta property='article:tag' content='chaos engineering'><meta property='article:published_time' content='2019-05-30T09:03:24-05:00'><meta property='article:modified_time' content='2019-05-30T09:03:24-05:00'><meta name=twitter:title content="Badass Monitoring, Pt 1: Sensu & Gremlin"><meta name=twitter:description content="Using chaos engineering principles to enhance your monitoring tools"></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu_f509edb42ecc0ebd.png width=300 height=300 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>ðŸŽ¸</span></figure><div class=site-meta><h1 class=site-name><a href=/>Staring Blankly at a Screen</a></h1><h2 class=site-description>Tech, beer, and the occasional banjo tune</h2></div></header><ol class=menu-social><li><a href=https://github.com/asachs01 target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://twitter.com/asachs01 target=_blank title=Twitter rel=me><svg class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M22 4.01c-1 .49-1.98.689-3 .99-1.121-1.265-2.783-1.335-4.38-.737S11.977 6.323 12 8v1c-3.245.083-6.135-1.395-8-4 0 0-4.182 7.433 4 11-1.872 1.247-3.739 2.088-6 2 3.308 1.803 6.913 2.423 10.034 1.517 3.58-1.04 6.522-3.723 7.651-7.742a13.84 13.84.0 00.497-3.753C20.18 7.773 21.692 5.25 22 4.009z"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/about/><svg class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg>
<span>About</span></a></li><li><a href=/talks/><span>Talks</span></a></li><li><a href=/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Dark Mode</span></li></ol></li></ol></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/monitoring/>Monitoring
</a><a href=/categories/sensu/>Sensu</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/archive/sensu-gremlin-intro/>Badass Monitoring, Pt 1: Sensu & Gremlin</a></h2><h3 class=article-subtitle>Using chaos engineering principles to enhance your monitoring tools</h3></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>May 30, 2019</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>4 minute read</time></div></footer></div></header><section class=article-content><p>One of my earliest jobs was as an admin for an MSP. We&rsquo;d routinely generate alerts that weren&rsquo;t actionable, lacked context, and for most of our customers, were considered noise. From a monitoring perspective, it was bad. Customers didn&rsquo;t trust in the alerts they received and often resorted to having some additional monitoring product installed on their systems. It&rsquo;s safe to say that our auto-generated tickets and emails were largely ignored.</p><p>In an effort to avoid repeating mistakes of the past, I want to ensure that I have actionable alerts that are context heavy. Thankfully, there are a couple of tools that I&rsquo;ve found go a long way in helping me with that effort: Sensu and Gremlin. I&rsquo;ll do an intro to those tools today, and we&rsquo;ll pick up on how these tools work together in the next post. It&rsquo;s worth mentioning that I am a Sensu employee.</p><p>With that out of the way, let&rsquo;s get to the tools!</p><h1 id=the-tools><strong>The Tools</strong></h1><h2 id=sensu><strong>Sensu</strong></h2><p>If you&rsquo;ve not used <a class=link href=https://sensu.io target=_blank rel=noopener>Sensu</a> before, allow me to make a formal introduction. At Sensu, we talk about it as a &ldquo;monitoring event pipeline.&rdquo; The concept is similar to a CI/CD pipeline, except that instead of releasing software software, I&rsquo;m sending monitoring event data. The goal with the pipeline being that by the time I receive a monitoring event or alert, I know beyond a shadow of a doubt that what I have in front of me has been verified and provides me with exactly what I need to act on the data.</p><p>For this series, I&rsquo;ll be using Sensu as my monitoring tool of choice.</p><h2 id=gremlin><strong>Gremlin</strong></h2><p>If you&rsquo;re in IT, you&rsquo;re probably familiar with Gremlins.</p><p>![gremlin gif][1]</p><p>Yes, those ones. They&rsquo;ve been known to cause many an issue, but in this case, I&rsquo;m talking about this [Gremlin][2] in particular. Gremlin is a [chaos engineering][3] tool that allows you to run targeted attacks on your infrastructure. This can be anything from a time-drift attack to more complicated types of attacks. The goal here will be to apply the principles of chaos engineering to uncover any weaknesses in our Sensu deployment and ensure that it is able to withstand real-world conditions.</p><p>We&rsquo;ll also use Gremlin to introduce conditions that will generate Sensu alerts. By introducing those conditions, we&rsquo;ll be able to ensure that the alerts generated follow the [CASE][4] method.</p><h1 id=the-setup><strong>The Setup</strong></h1><h2 id=sensu-1><strong>Sensu</strong></h2><p>I&rsquo;ve already set up Sensu in my own environment (which is Ubuntu 18.04), so I&rsquo;m not going to walk through that here. However, if you don&rsquo;t have a working Sensu deployment, you&rsquo;ll want to checkout the [Sensu installation doc][5], so that you can get all of the various Sensu components installed. It&rsquo;s worth noting that for some our later testing, we&rsquo;ll be using a clustered deployment. For that, you&rsquo;ll want to take a look at the [clustering doc][6].</p><h2 id=gremlin-1><strong>Gremlin</strong></h2><p>Just like Sensu, we&rsquo;ll need to install Gremlin&rsquo;s agent so we can start <del>doing pseudo-nefarious stuff</del> performing attacks on our test boxen. ðŸ˜ˆ In this case, since I&rsquo;m using Ubuntu 18.04 as my test box of choice, I&rsquo;ll also follow [Gremlin&rsquo;s installation guide][7] for Ubuntu as well (though it&rsquo;s for Ubuntu 16.04, this should still work in our case).</p><h1 id=next-steps>Next Steps</h1><p>Once you&rsquo;ve got both Sensu and Gremlin installed, let&rsquo;s run a couple of tests to make sure things are working like we expect them to.</p><h2 id=sensu-2>Sensu</h2><p>One of the cool things about Sensu is that you can monitor anything and you can have alerts generated from any number of things, not just the [community plugins][8] or [assets][8] Sensu offers. We can create some ad-hoc alerts using the [agent API][9] just to see what an alert might look like in our dashboard. To do that, run the following on your test VM:</p><pre><code>curl -X POST \
-H 'Content-Type: application/json' \
-d '{
  &quot;check&quot;: {
    &quot;metadata&quot;: {
      &quot;name&quot;: &quot;mysql-backup-job&quot;
    },
    &quot;status&quot;: 0,
    &quot;output&quot;: &quot;mysql backup initiated&quot;,
    &quot;ttl&quot;: 25200
  }
}' \
http://127.0.0.1:3031/events
</code></pre><p>That command creates a mock event and sends it to the agent API. Now, this might be useful if I had some sort of code that monitored a mysql backup job and emitted this message. In our case, it&rsquo;s just for us to make sure that we&rsquo;ve set up and configured Sensu correctly. A successful test should leave you with an event that looks something like this:</p><p></p><p>BOOM! ðŸ’¥ Our test worked! Let&rsquo;s just run a quick sample attack with Gremlin now.</p><h2 id=gremlin-2>Gremlin</h2><p>Just like we tested Sensu to make sure we&rsquo;re able to receive events, we&rsquo;re going to test our Gremlin agent. You can see me run the attack below:</p><p>Screen Recording 2019-06-14 at 03.25 PM.mov</p><p>There we have it! Both Sensu and Gremlin are working like we expect them to. In the next post, I&rsquo;m going to dig a bit more into the &ldquo;why&rdquo; of using a chaos engineering tool like Gremlin to test monitoring tools like Sensu.</p><p><em></em>
[1]: <a class=link href=https://media.giphy.com/media/BqPljBK6V9ZPG/giphy.gif target=_blank rel=noopener>https://media.giphy.com/media/BqPljBK6V9ZPG/giphy.gif</a>
[2]: <a class=link href=https://www.gremlin.com/ target=_blank rel=noopener>https://www.gremlin.com/</a>
[3]: <a class=link href=https://principlesofchaos.org/ target=_blank rel=noopener>https://principlesofchaos.org/</a>
[4]: <a class=link href=http://onemogin.com/monitoring/case-method-better-monitoring-for-humans.html target=_blank rel=noopener>http://onemogin.com/monitoring/case-method-better-monitoring-for-humans.html</a>
[5]: <a class=link href=https://docs.sensu.io/sensu-go/5.9/installation/install-sensu/#install-the-sensu-backend target=_blank rel=noopener>https://docs.sensu.io/sensu-go/5.9/installation/install-sensu/#install-the-sensu-backend</a>
[6]: <a class=link href=https://docs.sensu.io/sensu-go/5.9/guides/clustering/ target=_blank rel=noopener>https://docs.sensu.io/sensu-go/5.9/guides/clustering/</a>
[7]: <a class=link href=https://www.gremlin.com/community/tutorials/how-to-install-and-use-gremlin-on-ubuntu-16-04/ target=_blank rel=noopener>https://www.gremlin.com/community/tutorials/how-to-install-and-use-gremlin-on-ubuntu-16-04/</a></p></section><footer class=article-footer><section class=article-tags><a href=/tags/sensu/>Sensu</a>
<a href=/tags/gremlin/>Gremlin</a>
<a href=/tags/monitoring/>Monitoring</a>
<a href=/tags/chaos-engineering/>Chaos Engineering</a></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article><a href=/archive/sensu-gremlin-part-2/><div class=article-details><h2 class=article-title>Badass Monitoring, Pt 2: The 'Why'</h2></div></a></article><article><a href=/archive/sensu-go-on-osx/><div class=article-details><h2 class=article-title>Compiling and Running Sensu Go on OS X</h2></div></a></article><article><a href=/archive/sensu-go-on-arm/><div class=article-details><h2 class=article-title>Compiling and Running Sensu Go on ARM</h2></div></a></article><article><a href=/archive/monitoring-raspberry-pis-with-sensu/><div class=article-details><h2 class=article-title>Monitoring Raspberry Pi's with Sensu</h2></div></a></article><article><a href=/archive/minimal-sensu-docker/><div class=article-details><h2 class=article-title>A minimal Sensu environment with Docker</h2></div></a></article></div></div></aside><footer class=site-footer><section class=copyright>&copy;
2019 -
2025 Â© 2025 Aaron Sachs. All rights reserved.</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.30.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>